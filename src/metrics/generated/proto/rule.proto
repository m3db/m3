syntax = "proto3";
package schema;

import "policy.proto";

message MappingRule {
  map<string,string> tag_filters = 1;
  repeated Policy policies = 2;
}

message RollupTarget {
  string name = 1;
  repeated string tags = 2;
  repeated Policy policies = 3;
}

message RollupRule {
  map<string,string> tag_filters = 1;
  repeated RollupTarget targets = 2;
}

message RuleSet {
  string namespace = 1;
  int64 created_at = 2;
  int64 last_updated_at = 3;
  int32 version = 4;
  int64 cutover = 5;
  repeated MappingRule mapping_rules = 6;
  repeated RollupRule rollup_rules = 7;
}
