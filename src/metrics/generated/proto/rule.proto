syntax = "proto3";
package schema;

import "policy.proto";

message MappingRule {
  string name = 1;
  map<string,string> tag_filters = 2;
  repeated Policy policies = 3;
}

message RollupTarget {
  string name = 1;
  repeated string tags = 2;
  repeated Policy policies = 3;
}

message RollupRule {
  string name = 1;
  map<string,string> tag_filters = 2;
  repeated RollupTarget targets = 3;
}

message RuleSet {
  string namespace = 1;
  int64 created_at = 2;
  int64 last_updated_at = 3;
  bool tombstoned = 4;
  int32 version = 5;
  int64 cutover = 6;
  repeated MappingRule mapping_rules = 7;
  repeated RollupRule rollup_rules = 8;
}

message Namespaces {
  repeated string namespaces = 1;
  int64 ruleset_cutover = 2;
  int32 version = 3;
}